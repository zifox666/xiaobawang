<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="EVEè€é»„å†,EVE,æ˜Ÿæˆ˜å‰å¤œ,æ˜Ÿæˆ˜å‰å¤œï¼šæ™¨æ›¦">
    <title>EVE è€é»„å†</title>
    {% if is_screenshot %}
        <link rel="stylesheet" href="./index.css" />
    {% else %}
        <link rel="stylesheet" href="./index.css" />
        <link rel="stylesheet" href="./browser.css" />
    {% endif %}
    <script>
        // ä»…åœ¨æµè§ˆå™¨æ¨¡å¼ä¸‹è¿è¡Œ
        {% if not is_screenshot %}
        // Cookieæ“ä½œå‡½æ•°
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) {
                const cookieValue = parts.pop().split(';').shift();
                // è§£ç URLç¼–ç çš„Cookieå€¼
                return decodeURIComponent(cookieValue);
            }
            return null;
        }

        function checkAndReload() {
            // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°çš„ä¸€å¤©ï¼Œå¦‚æœæ˜¯å°±é‡æ–°åŠ è½½ä»¥è·å–æ–°çš„è¿åŠ¿
            const storedDate = getCookie('daily_luck_date');
            const today = new Date().toISOString().split('T')[0];
            
            if (storedDate && storedDate !== today) {
                // æ—¥æœŸä¸åŒï¼Œæ¸…é™¤æ—§æ•°æ®å¹¶é‡æ–°åŠ è½½
                document.cookie = 'daily_luck_data=; max-age=0;';
                document.cookie = 'daily_luck_date=; max-age=0;';
                location.reload();
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ—¥æœŸ
        window.addEventListener('load', checkAndReload);
        {% endif %}
    </script>
</head>
<body>

    <!--
        EVEè€é»„å†åŸå§‹ç¨‹åºä½œè€…  fake_faith
        åŸä½œè€… twitterï¼š @fake_faith  åŸAPPåä¸ºï¼šç¨‹åºå‘˜è€é»„å†
        ç”± XiaoBaWang ä¿®æ”¹

        EVEè€é»„å†ç¨‹åºéƒ¨åˆ† éµå¾ªGPLé€šç”¨è®¸å¯è¯å‘å¸ƒã€‚
        EVEè€é»„å†æ–‡å­—å†…å®¹éƒ¨åˆ† éµå¾ª CC-BY-SA 3.0 å‘å¸ƒ ï¼Œå‚è§ https://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh
    -->

    <div class="container">
        <div class="title">
            EVEè€é»„å†<sup>BETA</sup>
            <div style="float:right;font-size:10px">
                Powered By NoneBot-EVEDailyLucky<br>
            </div>
        </div>
        <div class="date">{{ today_str }}</div>

        <div style="text-align:center;margin:10px 0 15px;padding:8px;border:2px solid
            {% if luck_level == 'å¤§å‰' %}#d40000
            {% elif luck_level == 'ä¸­å‰' %}#ff8800
            {% elif luck_level == 'å°å‰' %}#ffbb00
            {% elif luck_level == 'å¹³å¹³æ— å¥‡' %}#607d8b
            {% elif luck_level == 'å°å‡¶' %}#0066cc
            {% else %}#4a148c
            {% endif %};
            border-radius:8px;background-color:
            {% if luck_level == 'å¤§å‰' %}#fff1f1
            {% elif luck_level == 'ä¸­å‰' %}#fff8e1
            {% elif luck_level == 'å°å‰' %}#fffde7
            {% elif luck_level == 'å¹³å¹³æ— å¥‡' %}#f5f7f8
            {% elif luck_level == 'å°å‡¶' %}#e3f2fd
            {% else %}#f3e5f5
            {% endif %};">
            <span style="font-size:13px;">ç”¨æˆ· {{ user_name[:15] }} çš„ä»Šæ—¥è¿åŠ¿æ˜¯:<br>
                <span style="
                    {% if luck_level == 'å¤§å‰' %}color:#d40000;
                    {% elif luck_level == 'ä¸­å‰' %}color:#ff8800;
                    {% elif luck_level == 'å°å‰' %}color:#ffbb00;
                    {% elif luck_level == 'å¹³å¹³æ— å¥‡' %}color:#607d8b;
                    {% elif luck_level == 'å°å‡¶' %}color:#0066cc;
                    {% else %}color:#4a148c;
                    {% endif %}font-size:24px;font-weight:bold;margin-top:2px;">{{ luck_level }}</span>
            </span>
            <div style="font-size:12px;color:#666;margin-top:1px;">å¥³ç¥çœ·é¡¾å€¼: {{ goddess_value }}</div>
        </div>

        <div class="good">
            <div class="title">
                <table>
                    <tbody>
                        <tr><td>å®œ</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="content">
                <ul>
                    {% for good_event in good_events %}
                        <li>
                            <div class="name">{{ good_event.name }}</div>
                            <div class="description">{{ good_event.good }}</div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="clear"></div>
        </div>

        <div class="split"></div>

        <div class="bad">
            <div class="title">
                <table>
                    <tbody>
                        <tr><td>ä¸å®œ</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="content">
                <ul>
                    {% for bad_event in bad_events %}
                        <li>
                            <div class="name">{{ bad_event.name }}</div>
                            <div class="description">{{ bad_event.bad }}</div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="clear"></div>
        </div>

        <div class="split"></div>

        <div class="line-tip">
            <strong>é€‚å®œä¼šæˆ˜åœ°ç‚¹: </strong><span class="direction_value">{{ direction }}</span>
        </div>
        <div class="line-tip">
            <strong>ä»Šæ—¥å¹¸è¿èˆ°èˆ¹: </strong><span class="ships_value">{{ ships }}</span>
        </div>
        <div class="line-tip">
            <strong>ä»Šæ—¥å¹¸è¿æ˜ŸåŸŸ: </strong><span class="spaces">{{ locals }}</span>
        </div>

        <!-- åˆ·æ–°å’Œè¯´æ˜åŒºåŸŸ ä»…åœ¨æµè§ˆå™¨æ¨¡å¼æ˜¾ç¤º -->
        {% if not is_screenshot %}
        <div style="text-align: center; margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
            <button id="refreshBtn" onclick="refreshLuck()" style="
                padding: 8px 16px;
                margin: 5px;
                background-color: #ff8800;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 14px;
            ">åˆ·æ–°æ•°æ®</button>
            
            <div style="font-size: 12px; color: #666; margin-top: 10px;">
                <p>ğŸ“ æœ¬é¡µæ•°æ®å·²ä¿å­˜è‡³æµè§ˆå™¨Cookie</p>
                <p>ğŸ”„ åŒä¸€å¤©å†…åˆ·æ–°ä¸ä¼šæ”¹å˜æ•°æ®ï¼Œæ–°çš„ä¸€å¤©è‡ªåŠ¨æ›´æ–°</p>
                <p>ğŸ—‘ï¸ æ¸…é™¤æµè§ˆå™¨Cookieå¯é‡æ–°è·å–ä»Šæ—¥é»„å†</p>
            </div>
        </div>

        <script>
            function refreshLuck() {
                // æ¸…é™¤æ‰€æœ‰ç›¸å…³Cookie
                document.cookie = 'daily_luck_data=; max-age=0;';
                document.cookie = 'daily_luck_date=; max-age=0;';
                // é‡æ–°åŠ è½½é¡µé¢
                location.reload();
            }
        </script>
        {% endif %}
    </div>

</body>
</html>
